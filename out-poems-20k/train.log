/home/ubuntu/nanoGPT/train.py:196: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=(dtype == 'float16'))
Overriding config with config/finetune_poem.py:
import time

out_dir = 'out-poems'
eval_interval = 5
eval_iters = 40
wandb_log = False # feel free to turn on
wandb_project = 'poems'
wandb_run_name = 'ft-' + str(time.time())

dataset = 'poems'
data_dir = "data/poems"
init_from = 'resume'

# only save checkpoints if the validation loss improves
always_save_checkpoint = False

# # match the small model config from train_shakespeare_char.py
# n_layer = 4
# n_head = 2
# n_embd = 384
# dropout = 0.2

# the number of examples per iter:
# 1 batch_size * 32 grad_accum * 1024 tokens = 32,768 tokens/iter
# poems has 400000 tokens, so 1 epoch ~= 12.2 iters
batch_size = 1
gradient_accumulation_steps = 32
max_iters = 30

# finetune at constant LR
learning_rate = 3e-5
decay_lr = False
tokens per iteration will be: 32,768
Resuming training from out-poems
number of parameters: 1555.97M
num decayed parameter tensors: 194, with 1,556,609,600 parameters
num non-decayed parameter tensors: 386, with 1,001,600 parameters
using fused AdamW: True
compiling the model... (takes a ~minute)
step 10: train loss 3.3529, val loss 3.5871
iter 10: loss 3.8529, time 50258.28ms, mfu -100.00%
iter 11: loss 3.5758, time 3115.14ms, mfu -100.00%
iter 12: loss 3.7584, time 3150.98ms, mfu -100.00%
iter 13: loss 3.4531, time 3151.03ms, mfu -100.00%
iter 14: loss 3.3908, time 3151.35ms, mfu -100.00%
step 15: train loss 2.9628, val loss 3.4605
iter 15: loss 3.0737, time 5399.35ms, mfu 20.00%
iter 16: loss 2.4594, time 3152.40ms, mfu 21.42%
iter 17: loss 2.8576, time 3156.10ms, mfu 22.70%
iter 18: loss 2.7281, time 3155.13ms, mfu 23.85%
iter 19: loss 2.2388, time 3152.46ms, mfu 24.89%
step 20: train loss 2.3498, val loss 3.5668
iter 20: loss 2.3990, time 5402.73ms, mfu 24.40%
iter 21: loss 2.7089, time 3154.49ms, mfu 25.38%
iter 22: loss 1.5303, time 3152.77ms, mfu 26.27%
iter 23: loss 2.1038, time 3153.40ms, mfu 27.07%
iter 24: loss 1.2273, time 3154.27ms, mfu 27.78%
step 25: train loss 1.5330, val loss 3.8077
iter 25: loss 1.4470, time 5401.65ms, mfu 27.00%
iter 26: loss 0.8691, time 3598.69ms, mfu 27.30%
iter 27: loss 0.8105, time 3155.53ms, mfu 27.99%
iter 28: loss 1.0926, time 3154.29ms, mfu 28.62%
iter 29: loss 1.0738, time 3155.19ms, mfu 29.18%
step 30: train loss 0.7467, val loss 4.3934
iter 30: loss 1.1381, time 5406.91ms, mfu 28.26%
training finished in 2m 2.81s
